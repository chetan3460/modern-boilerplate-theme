# Accordion Block - Code Examples & Advanced Usage\n\n## Template Rendering Examples\n\n### Basic Rendering (Simple Flexible Content)\n\n```php\n<?php\n// In your page template (e.g., page-legal.php)\nif (have_rows('page_panels')) {\n    while (have_rows('page_panels')) {\n        the_row();\n        $layout = get_row_layout();\n        \n        if ($layout === 'accordion_block') {\n            get_template_part('templates/blocks/accordion_block');\n        }\n    }\n}\n?>\n```\n\n### Using render_blocks() Helper\n\n```php\n<?php\n// In your page template\n// Renders all flexible content blocks including accordion\nrender_blocks('page_panels');\n?>\n```\n\n### Conditional Rendering\n\n```php\n<?php\n// Only render accordion blocks, skip others\nif (have_rows('page_panels')) {\n    while (have_rows('page_panels')) {\n        the_row();\n        if (get_row_layout() === 'accordion_block') {\n            get_template_part('templates/blocks/accordion_block');\n            break; // Only show first accordion\n        }\n    }\n}\n?>\n```\n\n## Alpine.js Integration Examples\n\n### Accessing Accordion State from Browser Console\n\n```javascript\n// Get accordion component\nconst accordion = document.querySelector('[data-component=\"AccordionBlock\"]').__x.$data;\n\n// Check which items are open\nconsole.log(accordion.openItems); // e.g., [0, 2]\n\n// Toggle specific item\naccordion.toggleItem(1);\n\n// Close all\naccordion.closeAll();\n\n// Open all\naccordion.openAll();\n```\n\n### Programmatic Control\n\n```html\n<div x-data=\"accordion({ allowMultiple: true, animated: true })\" id=\"my-accordion\">\n    <!-- Accordion items -->\n</div>\n\n<script>\n// From elsewhere in your page\nconst accordion = document.getElementById('my-accordion').__x.$data;\n\n// Open first 3 items\naccordion.openItems = [0, 1, 2];\n\n// Listen for changes (using Alpine's reactivity)\n// This is automatic - Alpine detects openItems changes\n</script>\n```\n\n## Custom Styling Examples\n\n### Add Custom CSS Override\n\n```css\n/* In your theme's custom CSS file */\n\n/* Override button styling */\n.accordion-item button {\n    background-color: #f0f0f0;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.accordion-item button:hover {\n    background-color: #e0e0e0;\n}\n\n/* Style open items differently */\n.accordion-item:has(button[aria-expanded=\"true\"]) {\n    border: 2px solid #da000e;\n}\n\n/* Custom panel styling */\n.accordion-item:has(button[aria-expanded=\"true\"]) > div[role=\"region\"] {\n    background-color: rgba(0, 0, 0, 0.02);\n}\n```\n\n### Tailwind CSS Customization\n\n```php\n// In your accordion_block.php template\n// Add custom Tailwind classes to the accordion wrapper\n<div class=\"accordion-wrapper max-w-4xl mx-auto drop-shadow-lg\">\n    <!-- Items -->\n</div>\n\n// Or for specific items\n<div class=\"accordion-item mb-3 last:mb-0 bg-light-blue rounded-lg overflow-hidden hover:shadow-md transition-shadow\">\n    <!-- Item content -->\n</div>\n```\n\n## Extending the Component\n\n### Add Animation on Open\n\n```javascript\n// In assets/js/main.js or similar\nAlpine.data('accordion', (config) => ({\n    openItems: [],\n    allowMultiple: config.allowMultiple ?? false,\n    animated: config.animated ?? true,\n    \n    toggleItem(index) {\n        // Original toggle logic\n        if (this.allowMultiple) {\n            if (this.openItems.includes(index)) {\n                this.openItems = this.openItems.filter(i => i !== index);\n            } else {\n                this.openItems.push(index);\n            }\n        } else {\n            if (this.openItems.includes(index)) {\n                this.openItems = [];\n            } else {\n                this.openItems = [index];\n            }\n        }\n        \n        // New: Trigger custom event\n        window.dispatchEvent(new CustomEvent('accordion:toggled', {\n            detail: { index, openItems: this.openItems }\n        }));\n    },\n    \n    closeAll() {\n        this.openItems = [];\n    },\n    \n    openAll() {\n        if (this.allowMultiple) {\n            this.openItems = Array.from({ length: document.querySelectorAll('[role=\"region\"]').length }, (_, i) => i);\n        }\n    }\n}));\n\n// Listen for events\nwindow.addEventListener('accordion:toggled', (e) => {\n    console.log('Accordion item toggled:', e.detail);\n});\n```\n\n### Track Accordion Usage in Analytics\n\n```javascript\n// In your main.js or analytics.js\nwindow.addEventListener('accordion:toggled', (e) => {\n    // Send to Google Analytics\n    if (window.gtag) {\n        gtag('event', 'accordion_toggle', {\n            item_index: e.detail.index,\n            open_items: e.detail.openItems.length,\n            page_path: window.location.pathname\n        });\n    }\n    \n    // Or send to custom analytics\n    fetch('/wp-admin/admin-ajax.php', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: new URLSearchParams({\n            action: 'track_accordion',\n            item_index: e.detail.index,\n            page_id: document.body.dataset.pageId\n        })\n    });\n});\n```\n\n## Data Structure Examples\n\n### What ACF Returns\n\n```php\n$accordion_items = get_sub_field('accordion_items');\n\n// Returns array like:\n[\n    [\n        'item_title' => 'Disclaimer',\n        'item_content' => '<p>Lorem ipsum...</p>'\n    ],\n    [\n        'item_title' => 'Cookies',\n        'item_content' => '<ul><li>Essential</li><li>Analytics</li></ul>'\n    ]\n]\n```\n\n### Programmatic Accordion Creation\n\n```php\n// If you need to create accordions programmatically\n// (Not recommended - use WordPress admin instead)\n\n$accordion_data = [\n    'hide_block' => false,\n    'title' => 'FAQ',\n    'subtitle' => 'Common questions',\n    'accordion_items' => [\n        [\n            'item_title' => 'Question 1',\n            'item_content' => '<p>Answer 1</p>'\n        ],\n        [\n            'item_title' => 'Question 2',\n            'item_content' => '<p>Answer 2</p>'\n        ]\n    ],\n    'accordion_settings' => [\n        'allow_multiple' => false,\n        'animated' => true,\n        'background_color' => 'light-blue'\n    ]\n];\n\n// Would need to be set via ACF functions\n// Not typical workflow - recommended to manage via WP admin\n```\n\n## API Endpoints Example\n\n### Expose Accordion Data via REST API\n\n```php\n// Add to functions.php\nadd_filter('acf/rest_api_enabled_post_types', function($post_types) {\n    return array_merge($post_types, ['page', 'post']);\n});\n\n// Now accessible via:\n// GET /wp-json/wp/v2/pages/123/?_fields=content,acf\n// Includes all accordion_block data\n```\n\n## Performance Optimization Examples\n\n### Lazy Load Accordion Content\n\n```php\n// Modify template to lazy-load content\n<?php foreach ($accordion_items as $index => $item): ?>\n    <div class=\"accordion-item\">\n        <button @click=\"toggleItem(<?php echo $index; ?>)\">\n            <!-- Button -->\n        </button>\n        <div\n            x-show=\"openItems.includes(<?php echo $index; ?>)\"\n            @content:load.window=\"if ($event.detail.index === <?php echo $index; ?>) { /* Load content */ }\"\n        >\n            <!-- Content loaded on demand -->\n        </div>\n    </div>\n<?php endforeach; ?>\n```\n\n### Cache Accordion Markup\n\n```php\n// In functions.php\nadd_filter('render_block_data', function($block) {\n    if ($block['blockName'] === 'accordion_block') {\n        // Cache accordion HTML for 1 hour\n        $cache_key = 'accordion_' . md5(json_encode($block['attrs']));\n        $cached = wp_cache_get($cache_key, 'blocks');\n        \n        if (!$cached) {\n            $cached = render_block($block);\n            wp_cache_set($cache_key, $cached, 'blocks', 3600);\n        }\n        \n        return $cached;\n    }\n    return $block;\n});\n```\n\n## Accessibility Testing Examples\n\n### Test Keyboard Navigation\n\n```html\n<!-- In your test suite -->\n<script>\n// Test keyboard support\nconst accordionButton = document.querySelector('.accordion-item button');\n\n// Simulate keyboard press\nconst keyEvent = new KeyboardEvent('keydown', {\n    key: 'Enter',\n    bubbles: true\n});\n\naccordionButton.dispatchEvent(keyEvent);\n\n// Check ARIA attributes\nconsole.log(\n    'aria-expanded:',\n    accordionButton.getAttribute('aria-expanded')\n);\nconsole.log(\n    'aria-controls:',\n    accordionButton.getAttribute('aria-controls')\n);\n</script>\n```\n\n## Real-World Examples\n\n### Legal/Privacy Page with Multiple Accordions\n\n```php\n<!-- page-legal.php -->\n<?php get_header(); ?>\n\n<div class=\"content\">\n    <?php\n    // General legal content\n    the_content();\n    \n    // All accordion blocks from flexible content\n    if (have_rows('legal_sections')) {\n        while (have_rows('legal_sections')) {\n            the_row();\n            if (get_row_layout() === 'accordion_block') {\n                get_template_part('templates/blocks/accordion_block');\n            }\n        }\n    }\n    ?>\n</div>\n\n<?php get_footer(); ?>\n```\n\n### FAQs with Category Filtering\n\n```html\n<!-- Hypothetical enhancement -->\n<div x-data=\"{\n    category: 'all',\n    get filteredItems() {\n        return this.accordion.openItems; // Could filter by category\n    }\n}\">\n    <!-- Category filters -->\n    <button @click=\"category = 'all'\">All</button>\n    <button @click=\"category = 'product'\">Product</button>\n    <button @click=\"category = 'billing'\">Billing</button>\n    \n    <!-- Accordion -->\n</div>\n```\n\n## TypeScript Types (if using TypeScript)\n\n```typescript\ninterface AccordionItem {\n    item_title: string;\n    item_content: string;\n}\n\ninterface AccordionSettings {\n    allow_multiple: boolean;\n    animated: boolean;\n    background_color: 'light-blue' | 'white' | 'grey';\n}\n\ninterface AccordionComponent {\n    openItems: number[];\n    allowMultiple: boolean;\n    animated: boolean;\n    toggleItem(index: number): void;\n    closeAll(): void;\n    openAll(): void;\n}\n```\n\n## Common Patterns\n\n### Open First Item by Default\n\n```javascript\n// Modify Alpine data initialization\nAlpine.data('accordion', (config) => ({\n    openItems: [0], // Start with first item open\n    // ... rest of component\n}));\n```\n\n### Sync Multiple Accordions\n\n```javascript\n// When one accordion opens, close others\nwindow.addEventListener('accordion:toggled', (e) => {\n    document.querySelectorAll('[data-component=\"AccordionBlock\"]').forEach(accordionEl => {\n        if (accordionEl !== e.target) {\n            accordionEl.__x.$data.closeAll();\n        }\n    });\n});\n```\n\n---\n\nFor more information, see `ACCORDION-BLOCK-SETUP.md` and `ACCORDION-QUICK-START.md`\n